@* @model bkfc.Models.Vendor *@
@model List<bkfc.Models.Food>

@{
    var vendor = (bkfc.Models.Vendor)ViewData["vendor"];
}

@{
    ViewData["Title"] = @vendor.Name;
    ViewData["css"] = "profile.css";
}
<div class="jumbotron jumbotron-fluid d-flex">
    <img src=@vendor.Logo alt="vendorLogo" style="width: 100px; height: 100px; object-fit: cover;" class="rounded mx-4"/>
    <div class="container">
        <h2> <i class="fas fa-store"></i> @vendor.Name  </h2>
        <p class="lead">@vendor.Category</p>
        <p>Quán này là quán ngon nhất tháng</p>
    </div>
</div>



<form method="get" asp-controller="Foodcourt" asp-action="Details" >

    <div class="input-group">
        <div class="custom-file">
            <input type="text" class="form-control" id="searchString" placeholder="What are you finding?" name="searchString" />
        </div>
        <div class="input-group-append">
            <button type="submit" class="btn btn-primary" value="Tìm kiếm">
                <svg class="bi bi-search" width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                    <path fill-rule="evenodd" d="M10.442 10.442a1 1 0 0 1 1.415 0l3.85 3.85a1 1 0 0 1-1.414 1.415l-3.85-3.85a1 1 0 0 1 0-1.415z" />
                    <path fill-rule="evenodd" d="M6.5 12a5.5 5.5 0 1 0 0-11 5.5 5.5 0 0 0 0 11zM13 6.5a6.5 6.5 0 1 1-13 0 6.5 6.5 0 0 1 13 0z" />
                </svg>
            </button>
        </div>
    </div>
</form>
@foreach (var foodModel in Model)
{
    <div class="container px-0 my-4 d-flex">
        <img style="width: 120px; height: 140px; object-fit: cover;" src=@foodModel.Image alt="kfc1" class="rounded">
        <div class="pl-3 d-flex flex-column justify-content-between" style="width: 100%;">
            <div>
                <h5>@foodModel.Name</h5>
                <p>@foodModel.Description</p>
            </div>
            
                @if( foodModel.Amount >0)
                {
                    var vendorId = vendor.Id;
                    var foodId = foodModel.Id;
                    <div id =@foodId>
                        <div class="font-weight-bold font-italic my-auto text-right">@foodModel.Price VND</div>    
                        <div class="d-flex justify-content-between text-center">
                            <div class="d-flex align-items-stretch">
                                <button class="btn btn-danger" type="button" name="button" onClick="decrease(@foodId)">
                                -
                                </button>
                                <input type="number" min="1" style="width: 50px;" id="quantity" class="quantity" value=1 size="2" onchange="change(@foodId)">
                                <button class="btn btn-primary" type="button" name="button" onClick="increase(@foodId)">
                                +
                                </button>
                            </div>
                                    
                            
                            <button type="submit"class="btn btn-primary" onClick="addToCart(@foodId)">Add to cart</button>
                        </div>

                    </div>
                    
                    
                }
                
        </div>

    </div>
}


<div class = "change-page">
    <a asp-action="Edit" asp-route-id="@vendor.Id">Edit</a> |
    <a asp-action="Delete" asp-route-id="@vendor.Id">Delete</a> |
    <a asp-action="Index">Back to List</a>
</div>


@section Scripts{
    <script type="text/javascript">
        function addToCart(foodId,vendorId)
        {
            var quantity = document.getElementById(foodId).getElementsByClassName("quantity")[0].value
            $.post('@Url.Action("AddToCart","Foodcourt")',{foodId:foodId,quantity: quantity});
        }
        function increase(foodId,foodPrice)
        {
            
            var quantity = ++document.getElementById(foodId).getElementsByClassName("quantity")[0].value;
        
        }
        function decrease(foodId,foodPrice)
        {
            quantityElement = document.getElementById(foodId).getElementsByClassName("quantity")[0];
            $.post('@Url.Action("decrease","Cart")',{foodId:foodId });
            if (quantityElement.value > 1)
            {
                quantityElement.value--;
            }
            
        }
        function change(foodId,foodPrice)
        {
            quantityElement = document.getElementById(foodId).getElementsByClassName("quantity")[0];
            if (quantityElement.value <= 0) quantityElement.value = 1;
        }


    </script>
}